<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta lang="en">
    <title>orlando | note</title>
    <link href="/assets/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/assets/css/main.css" rel="stylesheet">
    <meta name="description"   content="This is the official webpage of Gianluca Orlando, Assistant Professor in Mathematical Analysis at the Department of Mechanics, Mathematics & Management of Polytechnic of Bari. Gianluca Orlando's research focuses on Calculus of Variations, Gamma-convergence, semicontinuity and relaxation problems, applications to Fracture Mechanics (evolution for fracture, damage, plasticity, fatigue models) and Materials Science. He is also interested in the variational discrete-to-continuum analysis of spin systems (XY model, N-clock model, frustrated systems). Currently funded by Research for innovation - REFIN of Regione Puglia. 

    Questa è la pagina web ufficiale di Gianluca Orlando, Ricercatore a Tempo Determinato di tipo A in Analisi Matematica presso il Dipartimento di Meccanica, Matematica e Management (DMMM) del Politecnico di Bari (PoliBa). La ricerca di Gianluca Orlando è focalizzata sul calcolo delle variazioni, Gamma-convergenza, problemi di semicontinuità e rilassamento, applicazioni alla Meccanica delle Fratture (evoluzione per modelli di frattura, danno, plasticità, fatica) e Scienze dei Materiali. È anche interessato all'analisi variazionale dal discreto al continuo per sistemi di spin (modello XY, modello N-clock, sistemi frustrati). Al momento è finanziato dal programma Research for innovation - REFIN della Regione Puglia.">
    <meta name="keywords" content="Orlando, Gianluca, Politecnico di Bari, PoliBa, Dipartimento di Meccanica, Matematica e Management, DMMM, Analisi Matematica, didattica, ingegneria gestional, calcolo delle probabilità e statistica">
    <meta http-equiv='cache-control' content='no-cache'> 
    <meta http-equiv='expires' content='0'> 
    <meta http-equiv='pragma' content='no-cache'>
    <script src="/assets/js/scripts.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">

    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>

    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="google-site-verification" content="44tr-41mamfaxMm3K5fG48-GcmYgZDDBqX3aKtogsps" />
</head>
  <body>
    <div class="wrapper">
        <div class="pageContainer">
            <div class="nameContainer">
                <div style="cursor: pointer;" onclick="window.location='/';">
                    gianluca orlando
                    </div>
            </div>
            <div class="navContainer">
                <div id="menuButton" class="navElement-menu" style="cursor: pointer;" onclick="menu();">
    menu
</div>

    <div style="cursor: pointer;" onclick="window.location='/cv.html';" class="navElement">
        cv
    </div>

    <div style="cursor: pointer;" onclick="window.location='/research.html';" class="navElement">
        research
    </div>

    <div style="cursor: pointer;" onclick="window.location='/didattica.html';" class="navElement">
        didattica
    </div>

            </div>
            <div class="defaultContainer">
            <h2 id="una-breve-introduzione-non-rigorosa-al-controllo-ottimo">Una breve introduzione non rigorosa al controllo ottimo</h2>
<h3 id="riferimenti">Riferimenti</h3>
<ul>
  <li>Per un’introduzione semplice senza dimostrazioni: Capitolo 6 di <em>Introduction to Optimization</em>, Pedregal</li>
  <li>Per delle dimostrazioni scritte in modo molto diretto: note di Evans, <a href="https://math.berkeley.edu/~evans/control.course.pdf">link</a></li>
  <li>Un libro completo: <em>Functional Analysis, Calculus of Variations and Optimal Control</em>, Clarke</li>
  <li>Un approccio geometrico al controllo ottimo (servono dei prerequisiti di geometria differenziale): <em>Control Theory from the Geometric Viewpoint</em>, Agrachev &amp; Sachkov</li>
</ul>

<h2 id="problema-di-controllo-ottimo">Problema di controllo ottimo</h2>

<p>Il tipico <em>problema di controllo ottimo</em> è caratterizzato da un (sistema di) ODE (equazioni differenziali ordinarie) in cui l’incognita è una coppia di funzioni $(x(t), u(t))$. Consideriamo un intervallo di tempo $[0,T]$ e $N \geq 1$. La funzione $x \colon [0,T] \to \mathbb{R}^N$ rappresenta una traiettoria nello spazio $\mathbb{R}^N$ e $u \colon [0,T] \to \mathbb{R}^M$ è il cosiddetto <em>controllo</em>.</p>

<p>Il sistema di ODE è della forma 
\(\begin{equation}
\left\{
\begin{aligned}
\dot x(t) &amp; = f(x(t),u(t)) \, , \quad t \in [0,T] \, ,\\
x(0) &amp; = x^0 \, ,
\end{aligned}
\right.
\end{equation}\)
dove $x_0$ è un dato iniziale fissato e $f \colon \mathbb{R}^N {\times} \mathbb{R}^M \to \mathbb{R}^N$ e una funzione con una opportuna regolarità. Dato un controllo $u(t)$, esiste una unica soluzione del sistema di ODE (questo è un teorema che vale sotto debolissime ipotesi su $u(t)$, simile al teorema di Cauchy-Lipschitz per le ODE).</p>

<p>Al sistema di ODE è accoppiato un costo (o guadagno) per il controllo, tipicamente della forma
\(J(u) := \int_0^T L(t,x(t),u(t)) \, \mathrm{d} t \, ,\)
dove $x(t)$ è vincolato a essere la soluzione del sistema di ODE dato il controllo $u(t)$.</p>

<p><strong>Obiettivo</strong>: lo scopo del problema di controllo ottimo è quello di trovare $u \colon [0,T] \to \mathbb{R}^M$ tale che il costo $J$ sia minimizzato (nel caso in cui $J$ rappresenti un guadagno, lo scopo è quello di massimizzarlo).</p>

<p><strong>Costo</strong>: Il costo può avere anche altre forme che rispecchiano diversi obiettivi. Il tempo finale $T$ può anche essere variabile, come è tipico nei problemi di tempo ottimo.</p>

<p>È più semplice capire questo tipo di problemi guardando degli esempi concreti.</p>

<h2 id="esempi">Esempi</h2>

<h3 id="arrivo-più-economico-di-un-treno-alla-stazione">Arrivo più economico di un treno alla stazione</h3>
<p><strong>Problema</strong>: Far arrivare un treno ad una stazione spendendo meno costo possibile.</p>

<p>Scriviamo in modo rigoroso il problema. Il binario è rappresentato dalla retta reale $\mathbb{R}$. Il punto $0 \in \mathbb{R}$ rappresenta la stazione. Denotiamo con $q(t) \in \mathbb{R}$ la posizione del treno al tempo $t$ e denotiamo con $q_0 = q(0)$ la posizione al tempo iniziale $t = 0$, <em>e.g.</em>, la stazione di partenza. Il treno è fermo all’inizio, $\dot q(0) = 0$. Possiamo <em>controllare</em> l’accelerazione/decelerazione del treno. Il tempo finale $T$ è fissato, <em>e.g.</em>, è l’orario di arrivo del treno alla stazione finale. Imponiamo la condizione desiderata: al tempo finale $t = T$ la posizione del treno è alla stazione, quindi $q(T) = 0$, e il treno è fermo $\dot q(T) = 0$.</p>

<p><em>Dinamica</em>: In conclusione, il sistema è descritto da
\(\left\{
\begin{aligned}
    \ddot q(t) &amp; = u(t) \, , \quad  t \in [0,T] \, , \\
    q(0) &amp;= q^0 \, , \\
    \dot q(0) &amp;= 0 \, , \\
    q(T) &amp;= 0 \, , \\
    \dot q(T) &amp; = 0 \, .
\end{aligned}
\right.\)</p>

<p>La ODE (del secondo ordine) sembra un po’ diversa da quella scritta in generale (del primo ordine). In questi casi si riscrive la ODE come un sistema introducendo una variabile ausiliare $v(t) := \dot q(t)$ (la velocità). In questo modo la ODE diventa 
\(\left\{
\begin{aligned}
    \dot q(t) &amp; = v(t) \, , \\
    \dot v(t) &amp;= u(t) \, .
\end{aligned}
\right.\)
cioè, ponendo $x(t) = (q(t),v(t))$ e $f(x,u) = (x_2, u)$,
\(\left\{
\begin{aligned}
    \dot x(t) &amp; = f(x(t),u(t)) \, , \\
    x_1(0) &amp;= q^0 \, , \\
    x_2(0) &amp;= 0 \, , \\
    x_1(T) &amp;= 0 \, , \\
    x_2(T) &amp;= 0 \, .
\end{aligned}
\right.  \tag{1}\)</p>

<p><em>Costo</em>: Consideriamo il costo 
\(J(u) := \int_0^T \frac{1}{2} |u(t)|^2 \, \mathrm{d} t \, .\)
Questo costo può misurare (in modo quadratico) la quantità di carburante totale consumata.</p>

<p><em>Obiettivo</em>: Trovare un controllo $u^<em>(t)$ tale che $J$ sia minimo, cioè $J(u^</em>) \leq J(u)$ tra tutti i controlli possibili $u$ tali che il sistema $(1)$ viene soddisfatto.</p>

<h3 id="arrivo-più-veloce-di-un-treno-alla-stazione">Arrivo più veloce di un treno alla stazione</h3>

<p>Vediamo un esempio di problema in cui il tempo è libero.</p>

<p><strong>Problema</strong>: Far arrivare un treno ad una stazione nel minor tempo possibile.</p>

<p><em>Dinamica</em>: Il sistema è lo stesso di prima, ma questa volta il tempo finale $\tau$ sarà libero (è da trovare)
\(\left\{
\begin{aligned}
    \dot x(t) &amp; = f(x(t),u(t)) \, ,  \quad  t \in [0,\tau] \, , \\
    x_1(0) &amp;= q^0 \, , \\
    x_2(0) &amp;= 0 \, , \\
    x_1(\tau) &amp;= 0 \, , \\
    x_2(\tau) &amp;= 0 \, .
\end{aligned}
\right.  \tag{2}\)
dove $f(x,u) = (x_2, u)$.
Assumiamo che l’accelerazione massima sia limitata, ad esempio $|u(t)| \leq 1$ per ogni $t \in [0,\tau]$.</p>

<p><em>Costo</em>: Diciamo che $\tau$ è il primo tempo in cui $x(\tau) = 0$ e consideriamo il costo 
\(J(u) := \int_0^\tau 1 \, \mathrm{d} t = \tau \, .\)</p>

<p><em>Obiettivo</em>: Trovare un controllo $u^*(t)$ tale che il relativo $\tau$ sia minimo.</p>

<h3 id="soft-landing-versione-semplice">Soft landing (versione semplice)</h3>

<p><strong>Problema</strong>: Fare atterrare un razzo spendendo meno carburante possibile.</p>

<p>Consideriamo un razzo che deve atterrare in un tempo $T$ fissato su un pianeta e denotiamo con $h(t)$ la sua posizione rispetto a terra. L’altezza iniziale è $h(0) = h^0$. Denotiamo con $g$ l’accelerazione di gravità del pianeta e con $m$ la massa del razzo. Possiamo controllare il razzo imprimendo una forza $u(t)$ con i propulsori.</p>

<p><em>Dinamica</em>: Il sistema è descritto da 
\(\left\{
\begin{aligned}
    m \ddot h(t) &amp; = - m g + u(t) \, , \quad  t \in [0,T] \, , \\
    h(0) &amp;= h^0 \, , \\
    \dot h(0) &amp;= v^0 \, , \\
    h(T) &amp;= 0 \, , \\
    \dot h(T) &amp;= 0 \, .
\end{aligned}
\right.\)
L’ultima condizione dice che il razzo si ferma a terra.</p>

<p>Anche questo sistema si scrive nella forma 
\(\left\{
\begin{aligned}
    \dot x(t) &amp; = f(x(t),u(t)) \, , \quad  t \in [0,T] \, , \\
    x_1(0) &amp;= h^0 \, , \\
    x_2(0) &amp;= v^0 \, , \\
    x_1(T) &amp;= 0 \, , \\
    x_2(T) &amp;= 0 \, ,
\end{aligned}
\right.\)
dove $x = (h,v)$ e $f(x,u) = (x_2, -g + \frac{u}{m})$.</p>

<p><em>Costo</em>: Possiamo considerare costi come 
\(J(u) = \int_0^T |u(t)| \, \mathrm{d} t \quad \text{oppure} \quad J(u) = \int_0^T \frac{1}{2} |u(t)|^2 \, \mathrm{d} t  \, .\)</p>

<p><em>Obiettivo</em>: Trovare un controllo $u^*(t)$ tale che $J$ sia minimizzato tra tutti i controlli per cui vale la dinamica descritta sopra.</p>

<h3 id="soft-landing-versione-sofisticata">Soft landing (versione sofisticata)</h3>

<p><strong>Problema</strong>: Fare atterrare un razzo spendendo meno carburante possibile, tenendo conto della massa del carburante e con tempo libero.</p>

<p>Consideriamo un razzo che deve atterrare in un tempo $\tau$ <strong>non</strong> fissato. Questa volta teniamo conto del fatto che la massa del razzo può cambiare nel tempo per la perdita di carburante e denotiamola con $m(t)$.</p>

<p><em>Dinamica</em>: Il sistema è descritto da 
\(\left\{
\begin{aligned}
    m(t) \ddot h(t) &amp; = - m(t) g + u(t) \, , \quad  t \in [0,\tau] \, , \\
    \dot m(t) &amp; = - k u(t) \, ,\\
    h(0) &amp;= h^0 \, , \\
    \dot h(0) &amp;= v^0 \, , \\
    h(\tau) &amp;= 0 \, , \\
    \dot h(\tau) &amp;= 0 \, , \\
    m(0) &amp;= m^0 \, .
 \end{aligned}
\right.\)
La seconda equazione dice il rate di perdita di massa in funzione del carburante usato.</p>

<p>Anche questo sistema si scrive nella forma 
\(\left\{
\begin{aligned}
    \dot x(t) &amp; = f(x(t),u(t)) \, , \quad  t \in [0,T] \, , \\
    x_1(0) &amp;= h^0 \, , \\
    x_2(0) &amp;= v^0 \, , \\
    x_1(\tau) &amp;= 0 \, , \\
    x_2(\tau) &amp;= 0 \, , \\
    x_3(0) &amp;= m^0 \, .
\end{aligned}
\right.\)
dove $x = (h,v,m)$ (c’è anche l’incognita $m$) e $f(x,u) = (x_2, -g + \frac{u}{m}, -k m)$.</p>

<p><em>Costo</em>: Possiamo considerare il costo<br />
\(J(u) = m(\tau) \, ,\)
cioè la massa finale del razzo e $\tau$ è l’istante di atterraggio, cioè tale che $x_1(\tau) = x_2(\tau) = 0$.</p>

<p><em>Obiettivo</em>: Trovare un controllo $u^*(t)$ tale che $J$ sia massimizzato tra tutti i controlli per cui vale la dinamica descritta sopra (cioè il razzo atterra con più massa possibile).</p>

<h2 id="esistenza-di-controlli-ottimi">Esistenza di controlli ottimi</h2>

<p>Supponiamo che $u(t) \in U$ con $U \in \mathbb{R}^M$. Ci sono teoremi di esistenza per i problemi di controllo. Richiedono ipotesi su $f$ e sull’insieme a cui appartengono i controlli $U$. Un’ipotesi importante è che per ogni $x \in \mathbb{R}^N$ l’insieme ${f(x,u) : u \in U }$ sia convesso. Si consigliano i riferimenti citati sopra per i teoremi di esistenza (<em>e.g.</em>, Teorema di Filippov).</p>

<h2 id="condizioni-necessarie-il-principio-di-pontryagin">Condizioni necessarie: il principio di Pontryagin</h2>

<p>Per risolvere problemi come quelli descritti sopra (che raramente si riescono a risolvere indovinando il candidato controllo ottimo $u^*$) si cercano delle condizioni necessarie all’ottimalità del controllo.</p>

<p>[L’idea non è totalmente nuova: questo è quello che si fa per esempio quando si cercano i minimi di una funzione: raramente si possono trovare “a occhio” i minimi e per questo li si cerca tra i punti critici (un punto di minimo di una funzione regolare è critico!)]</p>

<p><em>Argomento euristico</em>: Ora proviamo a fornire un argomento <strong>molto informale</strong> per capire quali possono essere le condizioni necessarie per l’ottimalità di un controllo. Nel controllo ottimo si vuole minimizzare un costo $J$ rispetto a $u$ e deve essere rispettato un vincolo: $x$ deve risolvere l’ODE $\dot x = f(x,u)$. Come nella minimizzazione vincolata, introduciamo una nuova traiettoria $p \colon [0,T] \to \mathbb{R}^N$ che funga il ruolo di moltiplicatore di Lagrange. L’idea è di cercare punti critici per 
\(\int_0^T L(t,x(t),u(t))  - p(t) \cdot \big(\dot x(t) - f(x(t), u(t))\big) \, \mathrm{d} t \, .\)
Notare che $p$ è scontrata con il vincolo, come si farebbe per la minimizzazione vincolata classica.</p>

<p><em>Attenzione: l’argomento che segue è solamente euristico e non è assolutamente una dimostrazione! Per una dimostrazione si vedano i riferimenti consigliati, e.g., note di Evans.</em> Consideriamo una perturbazione $(x(t)+\delta x(t), p(t)+\delta p(t), u(t) + \delta u(t))$ di $(x(t),p(t),u(t))$ e imponiamo la condizione di punto critico (trascuriamo i termini di ordine inferiore $\delta^2$): 
\(\begin{aligned}
0 &amp; \simeq \int_0^T L(t,x(t)+\delta x(t),u(t)+\delta u(t))  - (p(t)+\delta p(t)) \cdot (\dot x(t) + \delta \dot x(t) - f(x(t)+\delta x(t), u(t) + \delta u(t)) ) \, \mathrm{d} t  - \int_0^T L(t,x(t),u(t))  - p(t) \cdot (\dot x(t) - f(x(t), u(t))) \, \mathrm{d} t \\
&amp; \simeq \int_0^T \nabla_x L(t,x(t),u(t)) \cdot \delta x(t)   + \nabla_u L(t,x(t),u(t)) \cdot  \delta u(t) - \delta p(t) \cdot (\dot x(t) - f(x(t), u(t))) - p(t) \cdot \delta \dot x(t) + \sum_i p_i(t) \nabla_x f_i(x(t), u(t)) \cdot \delta x(t) + \sum_i p_i(t) \nabla_u f_i(x(t), u(t)) \cdot \delta u(t) \\
&amp; \simeq \int_0^T \delta u(t) \cdot \Big( \nabla_u L(t,x(t),u(t)) + \sum_i p_i(t) \nabla_u f_i(x(t), u(t)) \Big) + \delta x(t) \cdot \Big( \dot p(t) + \nabla_x L(t,x(t),u(t)) + \sum_i p_i(t) \nabla_x f_i(x(t), u(t)) \Big) + \delta p(t) \cdot (f(x(t), u(t)) - \dot x(t)) \, \mathrm{d} t - p(T) \cdot \delta x(T) \\
&amp; \simeq \int_0^T \delta u(t) \cdot \Big( \nabla_u H(t,x(t),p(t),u(t)) \Big) + \delta x(t) \cdot \Big( \dot p(t) + \nabla_x H(t,x(t),p(t),u(t)) \Big) + \delta p(t) \cdot (\nabla_p H(t,x(t),p(t),u(t)) - \dot x(t)) \, \mathrm{d} t - p(T) \cdot \delta x(T)
\end{aligned}\)
dove abbiamo usato l’integrazione per parti:
$$</p>
<ul>
  <li>\int_0^T p(t)\cdot \delta \dot x(t) \, \mathrm{d} t  = - p(T)\cdot \delta x(T) + p(0)\cdot \delta x(0) + \int_0^T \dot p(t)\cdot \delta x(t) \, \mathrm{d} t = - p(T)\cdot \delta x(T) + \int_0^T \dot p(t)\cdot \delta x(t) \, \mathrm{d} t \, ,
\(il fatto che $\delta x(0) = 0$ (anche le traiettorie perturbate partono da $x^0$) e abbiamo definito la cosiddetta *Hamiltoniana*\)
H(t,x,p,u) := L(t,x,u) + p \cdot f(x,u) \, .
$$
(Se anche il punto finale è fissato, si ha che $\delta x(T) = 0$ e non si impongono condizioni per $p(T)$.)</li>
</ul>

<p>Siccome la condizione scritta sopra vale per ogni perturbazione, otteniamo che i termini scontrati con $\delta x(t)$, $\delta p(t)$, $\delta u(t)$ nell’integrale devono essere zero, cioè 
\(\left\{
\begin{aligned}
\dot x(t) &amp; = \nabla_p H(t,x(t),p(t),u(t)) \, , \\
\dot p(t) &amp; = -\nabla_x H(t,x(t),p(t),u(t)) \, , \\
x(0) &amp; = x^0 \, , \\
p(T) &amp; = 0 \, , \\
0 &amp; = \nabla_u H(t,x(t),p(t),u(t))  \, . 
\end{aligned}
\right.\)</p>

<p>Queste sono condizioni necessarie affinché $u$ sia un controllo ottimo.</p>

<p><strong>Principio di Pontryagin</strong>: Più precisamente, si dimostra che un controllo ottimo $u^<em>(t)$ risolve 
\(H(t,x^*(t),p^*(t),u^*(t)) \leq H(t,x^*(t),p^*(t),u)  \quad \text{per ogni } u \text{ ammissibile} \, ,\)
dove $(x^</em>(t), p^*(t))$ risolve il sistema 
\(\left\{
\begin{aligned}
\dot x^*(t) &amp; = \nabla_p H(t,x^*(t),p^*(t),u^*(t)) \, , \\
\dot p^*(t) &amp; = -\nabla_x H(t,x^*(t),p^*(t),u^*(t)) \, , \\
x^*(0) &amp; = x^0 \, , \\
p^*(T) &amp; = 0 \, . \\
\end{aligned}
\right.\)
Queste condizioni sono note come principio di Pontryagin e possono essere usate per cercare i controlli ottimi.</p>

<h2 id="esempio">Esempio</h2>
<h3 id="arrivo-più-economico-di-un-treno-alla-stazione-1">Arrivo più economico di un treno alla stazione</h3>
<p>Applichiamo il principio di Pontryagin per trovare un controllo ottimo per il problema presentato sopra, con dinamica
\(\left\{
\begin{aligned}
    \dot x(t) &amp; = f(x(t),u(t)) = (x_2(t), u(t)) \, , \\
    x_1(0) &amp;= q^0 \, , \\
    x_1(T) &amp;= 0 \, , \\
    x_2(T) &amp;= 0 \, .
\end{aligned}
\right.\)
e costo 
\(J(u) = \int_0^T \frac{1}{2} |u(t)|^2 \, \mathrm{d} t \, .\)</p>

<p><em>Hamiltoniana</em>: L’Hamiltoniana del principio di Pontryagin è
\(H(t,x,p,u) := \frac{1}{2} u^2 + p_1 x_2 + p_2 u\)
quindi il sistema di ODE in $(x,p)$ da risolvere è 
\(\left\{
\begin{aligned}
\dot x_1(t) &amp; = \partial_{p_1} H(t,x(t),p(t),u(t)) = x_2(t) \, , \\
\dot x_2(t) &amp; = \partial_{p_2} H(t,x(t),p(t),u(t)) = u(t) \, , \\
\dot p_1(t) &amp; = -\partial_{x_1} H(t,x(t),p(t),u(t)) = 0 \, , \\
\dot p_2(t) &amp; = -\partial_{x_2} H(t,x(t),p(t),u(t)) = - p_1(t) \, ,
\end{aligned}
\right.\)
con condizioni al bordo (osserviamo che ci sono sia condizioni al tempo $t = 0$ che al tempo $t = T$ che cambiano le condizioni su $p$)
\(\left\{
\begin{aligned}
x_1(0) &amp; = q^0 \, , \\
x_1(T) &amp; = 0 \, , \\
x_2(0) &amp; = 0 \, , \\
x_2(T) &amp; = 0 \, . \\
\end{aligned}
\right.\)
e la condizione $\nabla_u H = 0$ implica 
\(u = - p_2 \, .\)
Risolviamo il sistema:
\(\dot p_1(t) = 0 \quad \implies \quad p_1(t) = a \equiv const\)
\(\dot p_2(t) = - p_1(t) \equiv - a \quad \implies \quad p_2(t) = - a t - b\)
\(\dot x_2(t) = u(t) = - p_2(t) = at + b \quad \implies \quad x_2(t) = \frac{a}{2}t^2 + b t + c \, .\)
Imponiamo $x_2(0) = x_2(T) = 0$:
\(0 = x_2(0) = c \, , \quad 0 = x_2(T) =  \frac{a}{2}T^2 + b T \quad \implies \quad  b = - \frac{a}{2}T  \, .\)
Continuiamo a risolvere l’ODE:
\(\dot x_1(t) = x_2(t) = \frac{a}{2}t^2 - \frac{a}{2}T t + c \quad \implies \quad x_1(t) = \frac{a}{6}t^3 - \frac{a}{4}T t^2 + d\)
Imponiamo $x_1(0) = q^0$ e  $x_1(T) = 0$:
\(q^0 = x_1(0) = d  \, .\)
\(0 = x_1(T) = - \frac{a}{12}T^3 + q^0 \quad \implies \quad a = \frac{12 q^0}{T^3} \, .\)
In conclusione 
\(x_1(t) = \frac{2 q^0}{T^3}t^3 - \frac{3 q^0}{T^2} t^2 + q^0 , \quad u(t) =  \frac{12 q^0}{T^3} t - \frac{6 q^0}{T^2}  \, .\)</p>

<p>Facciamo un plot.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="kn">import</span> <span class="nn">matplotlib.animation</span> <span class="k">as</span> <span class="n">animation</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">T</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">timeSteps</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">tSample</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">timeSteps</span><span class="p">)</span>

<span class="c1"># initial position
</span><span class="n">q0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>

<span class="c1"># define the trajectory
</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">timeSteps</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">timeSteps</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">tSample</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">q0</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">q0</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">q0</span>

<span class="c1"># prepare the plot environment
</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span> 
<span class="n">fig</span><span class="p">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">axes</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> 
<span class="n">ax</span><span class="p">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>

<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">temp</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">""</span><span class="p">)</span> 
<span class="n">lines</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">init</span><span class="p">():</span>
    <span class="c1">#init lines
</span>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">line</span><span class="p">.</span><span class="n">set_data</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="k">return</span> <span class="n">lines</span>

<span class="c1"># define the animation
</span><span class="k">def</span> <span class="nf">animate</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> 	
    <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_data</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lines</span>

<span class="c1"># call the animator	 
</span><span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="p">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">timeSteps</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">T</span><span class="p">)</span> 

<span class="c1"># save the animation
</span><span class="n">anim</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'train.gif'</span><span class="p">)</span>

<span class="c1"># watch animation
</span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">'train.gif'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="train.gif" alt="gif" /></p>


            </div>
        </div>
    </div>
  </body>
</html>